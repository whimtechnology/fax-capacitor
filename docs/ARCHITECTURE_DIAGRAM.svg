<svg xmlns="http://www.w3.org/2000/svg" width="1280" height="720" viewBox="0 0 1280 720" role="img" aria-labelledby="title desc">
  <title id="title">Fax Capacitor Architecture Diagram</title>
  <desc id="desc">Pipeline from ingest to UI with failure paths for PDF render failure and low-confidence classification.</desc>
  <defs>
    <style>
      .bg { fill: #f8fafc; }
      .stage { fill: #ffffff; stroke: #1f2937; stroke-width: 2; rx: 14; }
      .stage-title { font: 700 24px Arial, sans-serif; fill: #111827; }
      .stage-body { font: 16px Arial, sans-serif; fill: #374151; }
      .arrow { stroke: #0f766e; stroke-width: 3; fill: none; marker-end: url(#arrowHead); }
      .fail { stroke: #b91c1c; stroke-width: 3; fill: none; stroke-dasharray: 8 8; marker-end: url(#arrowHeadFail); }
      .fail-box { fill: #fef2f2; stroke: #b91c1c; stroke-width: 2; rx: 12; }
      .fail-title { font: 700 20px Arial, sans-serif; fill: #7f1d1d; }
      .fail-body { font: 16px Arial, sans-serif; fill: #991b1b; }
      .label { font: 14px Arial, sans-serif; fill: #065f46; }
      .label-fail { font: 14px Arial, sans-serif; fill: #991b1b; }
    </style>
    <marker id="arrowHead" markerWidth="10" markerHeight="8" refX="9" refY="4" orient="auto">
      <polygon points="0 0, 10 4, 0 8" fill="#0f766e" />
    </marker>
    <marker id="arrowHeadFail" markerWidth="10" markerHeight="8" refX="9" refY="4" orient="auto">
      <polygon points="0 0, 10 4, 0 8" fill="#b91c1c" />
    </marker>
  </defs>

  <rect class="bg" x="0" y="0" width="1280" height="720" />

  <text x="640" y="56" text-anchor="middle" style="font: 700 34px Arial, sans-serif; fill: #111827;">FaxTriage AI - High-Level Flow</text>

  <rect class="stage" x="60" y="160" width="200" height="170" />
  <text class="stage-title" x="160" y="205" text-anchor="middle">Ingest</text>
  <text class="stage-body" x="160" y="235" text-anchor="middle">PDF upload</text>
  <text class="stage-body" x="160" y="258" text-anchor="middle">(manual now,</text>
  <text class="stage-body" x="160" y="281" text-anchor="middle">email watch later)</text>

  <rect class="stage" x="300" y="160" width="220" height="170" />
  <text class="stage-title" x="410" y="205" text-anchor="middle">PDF Processing</text>
  <text class="stage-body" x="410" y="235" text-anchor="middle">Validate file</text>
  <text class="stage-body" x="410" y="258" text-anchor="middle">Render pages</text>
  <text class="stage-body" x="410" y="281" text-anchor="middle">Create model input</text>

  <rect class="stage" x="560" y="160" width="230" height="170" />
  <text class="stage-title" x="675" y="205" text-anchor="middle">Claude Classification</text>
  <text class="stage-body" x="675" y="235" text-anchor="middle">Document type</text>
  <text class="stage-body" x="675" y="258" text-anchor="middle">Field extraction</text>
  <text class="stage-body" x="675" y="281" text-anchor="middle">Priority + confidence</text>

  <rect class="stage" x="830" y="160" width="200" height="170" />
  <text class="stage-title" x="930" y="205" text-anchor="middle">Queue / Store</text>
  <text class="stage-body" x="930" y="235" text-anchor="middle">SQLite record</text>
  <text class="stage-body" x="930" y="258" text-anchor="middle">Status + flags</text>
  <text class="stage-body" x="930" y="281" text-anchor="middle">Review workflow</text>

  <rect class="stage" x="1070" y="160" width="160" height="170" />
  <text class="stage-title" x="1150" y="205" text-anchor="middle">UI</text>
  <text class="stage-body" x="1150" y="235" text-anchor="middle">Priority queue</text>
  <text class="stage-body" x="1150" y="258" text-anchor="middle">PDF preview</text>
  <text class="stage-body" x="1150" y="281" text-anchor="middle">Action buttons</text>

  <path class="arrow" d="M260 245 L300 245" />
  <path class="arrow" d="M520 245 L560 245" />
  <path class="arrow" d="M790 245 L830 245" />
  <path class="arrow" d="M1030 245 L1070 245" />

  <text class="label" x="280" y="232" text-anchor="middle">ingest</text>
  <text class="label" x="540" y="232" text-anchor="middle">pages</text>
  <text class="label" x="810" y="232" text-anchor="middle">JSON</text>
  <text class="label" x="1050" y="232" text-anchor="middle">serve</text>

  <rect class="fail-box" x="285" y="430" width="250" height="160" />
  <text class="fail-title" x="410" y="475" text-anchor="middle">Failure: PDF Render</text>
  <text class="fail-body" x="410" y="505" text-anchor="middle">Corrupt or unreadable</text>
  <text class="fail-body" x="410" y="528" text-anchor="middle">page conversion fails</text>
  <text class="fail-body" x="410" y="551" text-anchor="middle">status: error/manual review</text>

  <rect class="fail-box" x="630" y="430" width="260" height="160" />
  <text class="fail-title" x="760" y="475" text-anchor="middle">Failure: Low Confidence</text>
  <text class="fail-body" x="760" y="505" text-anchor="middle">Model uncertainty or</text>
  <text class="fail-body" x="760" y="528" text-anchor="middle">ambiguous document type</text>
  <text class="fail-body" x="760" y="551" text-anchor="middle">flag for human review</text>

  <path class="fail" d="M410 330 L410 430" />
  <text class="label-fail" x="426" y="385">render failure</text>

  <path class="fail" d="M675 330 L760 430" />
  <text class="label-fail" x="742" y="372">low confidence</text>

  <path class="fail" d="M760 590 L930 590 L930 330" />
  <text class="label-fail" x="885" y="575">return to review queue</text>

  <path class="arrow" d="M930 330 L930 390 L1150 390 L1150 330" />
  <text class="label" x="1040" y="380" text-anchor="middle">classified and flagged items visible in UI</text>
</svg>
